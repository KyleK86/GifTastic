// Team Array
var team = ["Tennessee Volunteers", "Georgia Bulldogs", "Florida Gators", "Alabama Crimson Tide", "South Carolina Gamecocks", "Florida State Seminoles", "Ohio State Buckeyes", "Michigan State Spartans", "Arizona Sundevils", "Kentucky Wildcats", "Michigan Wolverines", "Oklahoma Sooners", "Texas Longhorns", "Mississippi Rebels", "Texas A&M Aggies", "Notre Dame Fighting Irish", "MTSU Blue Raiders", "Auburn Tigers", "Arkansas Razorbacks", "Illinois Illini"];

function displayGif() {
    var team = $(this).attr("data-name");
    var queryUrl = "https://api.giphy.com/v1/gifs/search?q=" + team + "&api_key=Qzq0uTPuaFMNytxJk1SR9xqF98pZ2FtH&limit=24";

    // Ajax call
    $.ajax({
        url: queryUrl,
        method: "GET"
    }).done(function (response) {
        // Empty's div holding previous Gifs
        $('.gifDisplay').empty();
        for (let i = 0; i < response.data.length; i++) {
            // Variables to add HTML elements and standardize images generated by buttons
            var gifDiv = $('<div class="gifDiv">');
            var rating = response.data[i].rating;
            var ratingDiv = $('<p>').html("Rating: " + rating);
            ratingDiv.addClass("ratingDisplay");
            var animated = response.data[i].images.fixed_height.url;
            var still = response.data[i].images.fixed_height_still.url;
            var gifImg = $('<img class="gImage">');

            // Defaulting gifs to still
            gifImg.attr('src', still);
            gifImg.attr('data-still', still);
            gifImg.attr('data-animate', animated);
            gifImg.attr('data-state', 'still')

            // Securing ratings appear after their respective gifs
            gifDiv.append(ratingDiv);
            gifDiv.prepend(gifImg);
            $('.gifDisplay').prepend(gifDiv);
        }
    });
};
// Onclick function to animate/pause gifs
$('.gifDisplay').on("click", ".gImage", function () {

    var state = $(this).attr('data-state');
    // If state = still, on click will animate the gif
    if (state == 'still') {
        $(this).attr('src', $(this).data('animate'));
        $(this).attr('data-state', 'animate');
    }
    // Otherwise, if state != still, gif will pause on click   
    else {
        $(this).attr('src', $(this).data('still'));
        $(this).attr('data-state', 'still');
    }
});

// New buttons function
function renderButtons() {
    $(".buttons-original").empty();
    // Verifying buttons
    for (let i = 0; i < team.length; i++) {
        let addButton = $('<button class="button">');
        addButton.addClass("team");
        addButton.attr("data-name", team[i]);
        addButton.html(team[i]);

        // Appends new buttons to the end of the list of existing buttons
        $(".buttons-original").append(addButton);
    }
};

// New button created when field has a value entered and then cleared after confirming
$(".add-gif").on("click", function (event) {
    event.preventDefault();
    var gifs = $(".gif-name").val().trim();
    team.push(gifs);
    $(".gif-name").val("");
    renderButtons();
});

// Calls the buttons to be created in the class 'team'
$(document).on("click", ".team", displayGif);
renderButtons();